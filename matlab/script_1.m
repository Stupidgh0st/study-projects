% Исходные данные:
Ht0 = -9.4541e+05; %J/kg

P0 = 60*101325; %Pa

Pa = 1.5*101325; %Pa

C = [23.1   45.8   8.1   5.7   5.7  7.1]; % O H C N Al Cl

W1 = [2  0  0  0  0  0; % O2
      0  2  0  0  0  0; % H2
      1  1  0  0  0  0; % OH
      1  2  0  0  0  0; % H2O
      0  0  0  2  0  0; % N2
      1  0  0  1  0  0; % NO
      1  0  1  0  0  0; % CO
      2  0  1  0  0  0; % CO2
      1  0  0  0  1  0; % AlO
      1  0  0  0  2  0; % Al2O
      0  1  0  0  1  0; % AlH
      0  0  0  0  0  2; %cl2
      0  1  0  0  0  1;%hcl
      0 0 0 0 1  2;]; %alcl2
  
  W2 = [0 0 0 0 1  0;  %Al
        3 0 0 0 2  0;] %Al2O3
       
    
M = [54.316387  220.75156   5504.4412   2830.3275   -1452.3974   480.0710995  -92.195054  9.4201091   -0.3974978; % O2
     40.782816  -2119.4816  7476.2362   -1133.0154  1070.0343    -375.27906  69.808944   -6.7118939   0.26221123; % H2
     53.560373  7185.7819   7514.0699   -1193.6487  1225.4837    -466.28289  92.951841   -9.5273706   0.39463884; % OH
     53.6277    -60008.456  7369.7266   504.14536   1003.769     -481.74652  102.47379   -10.692381   0.44473991; % H2O
     52.722143  -1885.3493  6183.1319   939.61975   7.4290406    -98.957196  29.645176   -3.6804323   0.17165783; % N2
     56.654617  19688.53    5986.4853   1702.7013   -548.08811   99.756451   -9.0098314  0.23100461   0.010371999; % NO
     53.708419  -28282.284  5982.3212   1370.6198   -281.80495   1.6967626   10.307196   -1.7365992   0.091892333; % CO
     54.176023  -96249.681  5689.7647   6948.0348   -3187.2165   907.51942   -154.34752  14.331037    -0.5571496; % CO2
     58.519749  17408.493   6367.0514   2505.3047   -1330.6498   420.95791   -76.919681  7.5743928    -0.30962628; % AlO
     73.475224  -35689.875  10192.913   3849.2796   -2198.8153   723.29057   -136.16917  13.608812    -0.55917125; % Al2O
     50.683352  58249.743   5782.2194   2155.2613   -739.39149   134.34416   -8.7035035  -.13867096   0.025708703 % AlH
     61.548894  -2334.446   7544.7022   1641.1953   -983.86612   354.36933   -71.250206  7.575904     -0.3312931;%cl2
      52.691784  -24024.488  6680.2853   -4.416624   576.48875    -269.37156  57.845309   -6.1047321   0.2562386;%hcl
     82.448259  -79591.094  11647.049   2411.5284   -1406.5219   470.36353   -89.764761  9.0740465    -0.37644653;%alcl2
     17.5971    27.295485  7399.6482  .12948462  -.014975024 0. 0. 0. 0.; %Al (932-4300)
     53.000175  -391289.13 34599.381  0.1452368  -0.010641708 0. 0. 0. 0.;% Al2O3(2303-6000)
     45.168916  58008.607   5353.7423   -412.44632  246.19247    -86.140481  17.415382   -1.8288189   0.077299666; % O
     33.340205  50632.635   4973.3569   -7.0529569  4.6424756    -1.6298902  0.31233272  -0.05078677  0.0012198069; % H
     43.651223  169440.18   4916.9336   125.94853   -124.10174   55.921214   -11.293991  1.0918904    -0.041516648; % C
     42.725638  111509.41   5015.7889   -92.295094  83.547477     -38.540677 8.9155623   -0.91401847  0.034707465; % N
     45.630131  74570.055   5143.7352   -182.22582  100.85343    -31.783806  5.8466711   -0.61930206  0.032455259; % Al
     45.723654  27365.638   5312.55     305.74464   -357.16969   150.8185    -32.245532  3.4771606    -0.15018714;]%Cl
   


%Ввод наименований компонентов
labels = {'O2', 'H2', 'OH', 'H2O', 'N2', 'NO', 'CO', 'CO2', 'AlO', 'Al2O', 'AlH','Cl2','HCl','AlCl2', 'Al_c', 'Al2O3_c', 'O', 'H', 'C', 'N', 'Al','Cl'};
 
 
%%% Расчет
 
T = 1000:100:4000; % температурный диапазон


Ht = zeros(1, length(T));
St = zeros(1, length(T));

% Расчет параметров в камере сгорания
for i = 1:length(T)
    [RPm1,RPc1,RPa1,ns1,Ht(i)] = tdclc(P0,T(i),C,W1,W2,M);
end
figure(1), plot(T, Ht), hold on, grid on
plot([T(1), T(end)], [Ht0 Ht0], 'r:'), drawnow
%%
T0 = 3567.7; %<<<<<<<<<<<<<<- ввод значения T0
[RPm1,RPc1,RPa1,ns1,Ht1,St1] = tdclc(P0,T0,C,W1,W2,M) % с выводом на экран

%Диаграмма
xticks = 1:length([RPm1, RPc1, RPa1]);
figure(2), bar([RPm1, RPc1, RPa1]) 
set(gca,'XTick',xticks,'XTickLabel',labels)

% Расчет параметров на срезе сопла
for i = 1:length(T)
    [RPm2,RPc2,RPa2,ns2,Ht2,St(i)] = tdclc(Pa,T(i),C,W1,W2,M);
end
figure(3), plot(T, St), hold on, grid on
plot([T(1), T(end)], [St1 St1], 'r:'), drawnow
%%
Ta = 2233; %<<<<<<<<<<<<<<- ввод значения Ta
[RPm2,RPc2,RPa2,ns2,Ht2,St2] = tdclc(Pa,Ta,C,W1,W2,M) % с выводом на экран
%Диаграмма
figure(4), bar([RPm2, RPc2, RPa2])
set(gca,'XTick',xticks,'XTickLabel',labels), drawnow
 